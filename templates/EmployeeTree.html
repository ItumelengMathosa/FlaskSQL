<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tree Structure</title>

    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 25%;
            font-family: Arial, sans-serif;
        }
       

        /* It's supposed to look like a tree diagram */
        .tree,
        .tree ul,
        .tree li {
            list-style: none;
            margin: 0;
            padding: 0;
            position: relative;
        }

        .tree {
            margin: 1em 0; /* Adjust margin as needed */
            text-align: center;
        }

        .tree,
        .tree ul {
            display: table;
        }

        .tree ul {
            width: 100%;
        }

        .tree li {
            display: table-cell;
            padding: .5em 0;
            vertical-align: top;
        }

        .tree li:before {
            outline: solid 1px #666;
            content: "";
            left: 0;
            position: absolute;
            right: 0;
            top: 0;
        }

        .tree li:first-child:before {
            left: 50%;
        }

        .tree li:last-child:before {
            right: 50%;
        }

        .tree code,
        .tree span {
            border: solid .1em #727171;
            border-radius: .2em;
            display: inline-block;
            margin: 0 .2em .5em;
            padding: .2em .5em;
            position: relative;
        }

        .tree code {
            font-family: monaco, Consolas, 'Lucida Console', monospace;
        }

        .tree ul:before,
        .tree code:before,
        .tree span:before {
            outline: solid 1px #727171;
            content: "";
            height: .5em;
            left: 50%;
            position: absolute;
        }

        .tree ul:before {
            top: -.5em;
        }

        .tree code:before,
        .tree span:before {
            top: -.55em;
        }

        .tree>li {
            margin-top: 0;
        }

        .tree>li:before,
        .tree>li:after,
        .tree>li>code:before,
        .tree>li>span:before {
            outline: none;
        }

        form {
            width: 300px;
            text-align: center;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 8px;
            margin-top: 1em; /* Add margin between the tree and the form */
        }

        .form-container{
            display: flex;
            justify-content: space-around;
        }
        

        label {
            display: inline;
            margin-top: 16px;
            margin-bottom: 8px;
            text-align: left;
        }

        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        button:hover {
            background-color: #45a049;
        }

        input {
            display: inline-block;
            width: calc(100% - 16px); /* Adjust the width and margin as needed */
            padding: 8px;
            box-sizing: border-box;
            margin-bottom: 16px;
        }
        select{
            display: inline-block;
            width: calc(100% - 16px); /* Adjust the width and margin as needed */
            padding: 8px;
            box-sizing: border-box;
            margin-bottom: 16px;
        }
    </style>

    <!-- CSS to create tree display sourced from https://codepen.io/ross-angus/pen/jwxMjL-->
</head>

<body>
    

    <!-- CSS applied to generated Multi-Tree passed from 'EmployeeTree' function-->
    <div>
        

        <ul class="tree">
            <!-- autoescape renders the 'htmlcontent' variable as actual html code and not just a string variable -->
            {% autoescape off%}
            {{htmlcontent}}
            {% endautoescape %}
        </ul>

        <!-- Form for adding a new Employee -->

        <div class="form-container">

            <form id="AddEmployeeForm" action="/AddNewEmployee" method="post">
                <h2>Add New Employee</h2>
                
    
                <label for="name">Name:</label>
                <input type="text" id="name" name="name" required>
    
                <label for="birthDate">Birth Date:</label>
                <input type="date" id="birthDate" name="birthDate" required>
    
                <label for="addNodeManagerId">Manager ID:</label>
                <input type="text" id="addNodeManagerId" name="addNodeManagerId" placeholder="Click on node to assign manager" required readonly>
    
                <label for="role">Role:</label>
                <input type="text" id="role" name="role" required>
    
                <label for="salary">Salary:</label>
                <input type="number" id="salary" name="salary" required>
    
                <button type="submit">Add New Employee</button>
            </form>

            <form id="EditEmployeeForm">

                <h2>Edit Employee</h2>

                <label for="editNodeIDInput">Employee ID:</label>
                <input type="text" id="editNodeIDInput" name="editNodeIDInput" placeholder="Selected ID" required readonly>
    
                <label for="editNodeNameInput">Name:</label>
                <input type="text" id="editNodeNameInput" name="editNodeNameInput" required>
    
                <label for="editNodeBirthDateInput">Birth Date:</label>
                <input type="date" id="editNodeBirthDateInput" name="editNodeBirthDateInput" required>
    
                <label for="editNodeManagerIdInput">Manager ID:</label>
                <select id="editNodeManagerIdInput" name="editNodeManagerIdInput" required>
                    <!-- Options will be dynamically generated here -->
                </select>
    
                <label for="editNodeEmployeeNumberInput">Employee Number:</label>
                <input type="text" id="editNodeEmployeeNumberInput" name="editNodeEmployeeNumberInput" readonly required>
    
                <label for="editNodeRoleInput">Role:</label>
                <input type="text" id="editNodeRoleInput" name="editNodeRoleInput" required>
    
                <label for="editNodeSalaryInput">Salary:</label>
                <input type="number" id="editNodeSalaryInput" name="editNodeSalaryInput" required>
    
                <button type="submit">Edit</button>
            </form>

            <form id="DeleteEmployeeForm">
                <h2>Delete Employee</h2>

                <label for="deletionNodeIDInput">Employee ID:</label>
                <input type="text" id="deletionNodeIDInput" name="deletionNodeIDInput" placeholder="Selected Node" required readonly>
                
                <label for="deletionNodeNameInput">Employee ID:</label>
                <input type="text" id="deletionNodeNameInput" name="deletionNodeNameInput" placeholder="Selected Node" required readonly>

                <button type="submit">Delete</button>
            </form>
            
        </div>
        
    </div>

    <script>
        //handleNodeClick is called in 'EmployeeTree.py' in the generate_tree_html() function. 
        //Every node or 'li' has HandleNodeClick inside of their html element tag
        function HandleNodeClick(nodeName, nodeID, managerId, birthDate, employeeNumber, salary, role) {
            // Update the input element with the clicked node's information

            document.getElementById('deletionNodeIDInput').value = nodeID;
            document.getElementById('deletionNodeNameInput').value = nodeName;

            
            //Sets the addNodeManagerID in 'Add Employee' form's value equal to the node that was clicked
            document.getElementById('addNodeManagerId').value = nodeID;

            //Sets all inputs in 'Edit Employee' form equal to all values of node that was clicked

            document.getElementById('editNodeIDInput').value = nodeID;
            document.getElementById('editNodeNameInput').value = nodeName;
            document.getElementById('editNodeBirthDateInput').value = birthDate;

            //document.getElementById('editNodeManagerIdInput').value = managerId;
            document.getElementById('editNodeEmployeeNumberInput').value = employeeNumber;
            document.getElementById('editNodeRoleInput').value = role;
            document.getElementById('editNodeSalaryInput').value = salary;
        }

        function populateDropdown() {
            var dropdown = document.getElementById('editNodeManagerIdInput');
            var nodeNames = [];

            // Iterate through all <li> elements on the page
            var listItems = document.querySelectorAll('li');
            listItems.forEach(function (li) {
                var nodeName = li.getAttribute('id'); // Get the 'id' attribute of the <li>
                if (nodeName) {
                    nodeNames.push(nodeName.trim());
                }
            });

            // Clear existing options
            dropdown.innerHTML = '';

            // Add a default empty option
            var defaultOption = document.createElement('option');
            defaultOption.value = '';
            defaultOption.text = 'Select a Manager';
            dropdown.appendChild(defaultOption);

            // Add options for each node name
            for (var i = 0; i < nodeNames.length; i++) {
                var option = document.createElement('option');
                option.value = nodeNames[i];
                option.text = nodeNames[i];
                dropdown.appendChild(option);
            }
        }

    // Call the function to populate the dropdown
    populateDropdown();
    </script>

</body>

</html>
